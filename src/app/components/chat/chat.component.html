<div class="chat">

  <div *ngIf="innerWidth > 1100" class="chat-nav">

    <div class="chat-info">
      <span class="title" [textContent]="chat.title"></span>
      <span class="subtitle" [textContent]="chat.subtitle"></span>
    </div>

    <svg class="desktop-svg" (click)="closeChat()" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13.41,12l4.3-4.29a1,1,0,1,0-1.42-1.42L12,10.59,7.71,6.29A1,1,0,0,0,6.29,7.71L10.59,12l-4.3,4.29a1,1,0,0,0,0,1.42,1,1,0,0,0,1.42,0L12,13.41l4.29,4.3a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42Z"/></svg>

  </div>

  <div *ngIf="innerWidth < 1100" class="chat-nav-mobile">

    <svg (click)="closeChat()" class="mobile-svg" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z" opacity=".87"/><path class="path" d="M16.62 2.99c-.49-.49-1.28-.49-1.77 0L6.54 11.3c-.39.39-.39 1.02 0 1.41l8.31 8.31c.49.49 1.28.49 1.77 0s.49-1.28 0-1.77L9.38 12l7.25-7.25c.48-.48.48-1.28-.01-1.76z"/></svg>

    <div class="chat-info">
      <span class="title" [textContent]="chat.title"></span>
      <span class="subtitle" [textContent]="chat.subtitle"></span>
    </div>

    <img class="chat-image" src="{{chat.image}}" alt="">

  </div>

  <div class="messages">

    <span class="no-messages" *ngIf="chat.messages.length == 0">No messages yet</span>

    <div class="message-wrapper" *ngFor="let message of chat.messages; let i = index">

      <img *ngIf="lastMessageFromUser == i && message.fromUser == true" class="message-sender-image" src="{{getChatImage(message, chat)}}" alt="">
      <img *ngIf="lastMessageFromMe == i && message.fromUser == false" class="message-sender-image" src="{{getChatImage(message, chat)}}" alt="">
      <div *ngIf="lastMessageFromMe != i && message.fromUser == false" class="message-no-image"></div>
      <div *ngIf="lastMessageFromUser != i && message.fromUser == true" class="message-no-image"></div>

      <div class="message">
        <span class="text-message" [ngStyle]="{'background-color': (message.fromUser) ? '#2b5378' : '#182533'}" *ngIf="message.text != ''" [textContent]="message.text"></span><span [ngStyle]="{'background-color': (message.fromUser) ? '#2b5378' : '#182533'}" class="text-message time" *ngIf="message.text != ''" [textContent]="message.time"></span>
        <span class="text-message link" (click)="navigate(message.link)" *ngIf="message.link != ''" [textContent]="message.link"></span><span class="text-message time" *ngIf="message.link != ''" [textContent]="message.time"></span>
        <img class="message-image" *ngIf="message.image != ''" src="{{message.image}}" alt="">
        <iframe class="video-frame" *ngIf="message.video != ''" width="560px" height="315px" src="https://www.youtube.com/embed/ynLUOjXROL8" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
      </div>

    </div>

  </div>

  <div class="user-input">

    <svg class="clip" xmlns="http://www.w3.org/2000/svg" fill="#727783" version="1.1" id="Capa_1" width="800px" height="800px" viewBox="0 0 950 950" xml:space="preserve">
      <g>
	      <path d="M857.7,141.3c-30.1-30.1-65.1-53.5-104.3-69.4c-37.8-15.3-77.7-23.2-118.7-23.2c-40.9,0-80.9,7.7-118.7,22.9   c-39.1,15.8-74.2,38.9-104.3,68.8L73.1,478.3C49.3,501.9,30.9,529.4,18.3,560.2C6.2,589.9,0,621.3,0,653.6   C0,685.7,6.1,717,18.1,746.7c12.4,30.7,30.7,58.2,54.3,81.899c23.6,23.7,51.2,42,81.9,54.5c29.7,12.101,61.1,18.2,93.3,18.2   c32.2,0,63.6-6.1,93.3-18.1c30.8-12.5,58.399-30.8,82.1-54.4l269.101-268c17.3-17.2,30.6-37.3,39.699-59.7   c8.801-21.6,13.2-44.5,13.2-67.899c0-48.2-18.8-93.2-52.899-127c-34-34.2-79.2-53.1-127.301-53.3c-48.199-0.1-93.5,18.6-127.6,52.7   L269.6,473.3c-8.5,8.5-13.1,19.7-13.1,31.601c0,11.899,4.6,23.199,13.1,31.6l0.7,0.7c17.4,17.5,45.8,17.5,63.3,0.1l168-167.5   c35.1-34.8,92.1-35,127.199-0.399c16.9,16.8,26.101,39.3,26.101,63.399c0,24.3-9.4,47.101-26.5,64.101l-269,268   c-0.5,0.5-0.9,0.899-1.2,1.5c-29.7,28.899-68.9,44.699-110.5,44.5c-41.9-0.2-81.2-16.5-110.6-46c-14.7-15-26.1-32.5-34-52   C95.5,694,91.7,674,91.7,653.6c0-41.8,16.1-80.899,45.4-110.3c0.4-0.3,0.7-0.6,1.1-0.899l337.9-337.8c0.3-0.3,0.6-0.7,0.899-1.1   c21.4-21,46.3-37.4,74-48.5c27-10.8,55.4-16.2,84.601-16.2c29.199,0,57.699,5.6,84.6,16.4c27.9,11.3,52.9,27.8,74.3,49.1   c21.4,21.4,37.9,46.4,49.2,74.3c10.9,26.9,16.4,55.4,16.4,84.6c0,29.3-5.5,57.9-16.5,85c-11.301,28-28,53.2-49.5,74.8l-233.5,232.8   c-8.5,8.5-13.2,19.7-13.2,31.7s4.7,23.2,13.1,31.6l0.5,0.5c17.4,17.4,45.8,17.4,63.2,0L857.5,586.9   C887.601,556.8,911,521.7,926.9,482.6C942.3,444.8,950,404.9,950,363.9c0-40.9-7.8-80.8-23.1-118.5   C911.101,206.3,887.8,171.3,857.7,141.3z"/>
      </g>
    </svg>

      <input id="userInput" [disabled]="!authService.isLoggedIn" #input (keyup.enter)="sendTextMessage(input)" (input)="onInputChange(input.value)" type="text" placeholder="Write a message...">

    <!--<svg class="emoji" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
      <path fill-rule="evenodd" clip-rule="evenodd" d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12Z" fill="black"/>
      <path d="M11 9.5C11 10.3284 10.3284 11 9.5 11C8.67157 11 8 10.3284 8 9.5C8 8.67157 8.67157 8 9.5 8C10.3284 8 11 8.67157 11 9.5Z" fill="black"/>
      <path fill-rule="evenodd" clip-rule="evenodd" d="M9.5 10C9.77614 10 10 9.77614 10 9.5C10 9.22386 9.77614 9 9.5 9C9.22386 9 9 9.22386 9 9.5C9 9.77614 9.22386 10 9.5 10ZM9.5 11C10.3284 11 11 10.3284 11 9.5C11 8.67157 10.3284 8 9.5 8C8.67157 8 8 8.67157 8 9.5C8 10.3284 8.67157 11 9.5 11Z" fill="black"/>
      <path d="M16 9.5C16 10.3284 15.3284 11 14.5 11C13.6716 11 13 10.3284 13 9.5C13 8.67157 13.6716 8 14.5 8C15.3284 8 16 8.67157 16 9.5Z" fill="black"/>
      <path fill-rule="evenodd" clip-rule="evenodd" d="M14.5 10C14.7761 10 15 9.77614 15 9.5C15 9.22386 14.7761 9 14.5 9C14.2239 9 14 9.22386 14 9.5C14 9.77614 14.2239 10 14.5 10ZM14.5 11C15.3284 11 16 10.3284 16 9.5C16 8.67157 15.3284 8 14.5 8C13.6716 8 13 8.67157 13 9.5C13 10.3284 13.6716 11 14.5 11Z" fill="black"/>
      <path fill-rule="evenodd" clip-rule="evenodd" d="M7.42662 13.1808C7.87907 12.8641 8.5026 12.9741 8.81932 13.4266C9.30834 14.1252 10.2125 14.9219 11.291 15.1459C12.275 15.3503 13.6411 15.1262 15.2568 13.3311C15.6263 12.9206 16.2585 12.8873 16.6691 13.2567C17.0796 13.6262 17.1128 14.2585 16.7434 14.669C14.759 16.8738 12.7085 17.4831 10.8842 17.1041C9.15432 16.7448 7.8585 15.5415 7.18085 14.5735C6.86414 14.121 6.97417 13.4975 7.42662 13.1808Z" fill="black"/>
    </svg>-->

    <svg *ngIf="input.value != ''" (click)="sendTextMessage(input)" class="send" xmlns="http://www.w3.org/2000/svg" version="1.0" width="50.000000pt" height="50.000000pt" viewBox="0 0 50.000000 50.000000" preserveAspectRatio="xMidYMid meet">

      <g transform="translate(0.000000,50.000000) scale(0.100000,-0.100000)" fill="#000000" stroke="none">
        <path d="M30 417 c0 -21 196 -187 220 -187 25 0 220 166 220 187 0 10 -43 13 -220 13 -177 0 -220 -3 -220 -13z"/>
        <path d="M30 271 l0 -111 65 51 c36 28 65 52 65 54 0 1 -29 28 -65 60 l-65 57 0 -111z"/>
        <path d="M370 295 c-102 -91 -131 -102 -165 -65 -10 12 -25 18 -32 16 -27 -11 -143 -110 -143 -123 0 -10 28 -13 125 -13 118 0 125 1 125 20 0 17 7 20 50 20 46 0 49 1 39 19 -15 23 -5 51 18 51 9 0 32 -14 50 -32 l33 -32 0 112 c0 62 -1 112 -2 111 -2 0 -46 -38 -98 -84z"/>
        <path d="M380 193 c0 -4 12 -20 27 -35 l27 -28 -67 0 c-38 0 -67 -4 -67 -10 0 -6 29 -10 67 -10 l67 0 -29 -30 c-45 -47 -19 -49 28 -2 l41 42 -39 40 c-37 38 -55 49 -55 33z"/>
      </g>
    </svg>

    <!--<svg *ngIf="input.value == ''" class="mic" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18a6 6 0 0 0 6-6V6A6 6 0 0 0 6 6v6a6 6 0 0 0 6 6zM8 6a4 4 0 0 1 8 0v6a4 4 0 0 1-8 0z"/><path d="M21 12a1 1 0 0 0-2 0 7 7 0 0 1-14 0 1 1 0 0 0-2 0 9 9 0 0 0 8 8.94V22h-1a1 1 0 0 0 0 2h4a1 1 0 0 0 0-2h-1v-1.06A9 9 0 0 0 21 12z"/></svg>-->
  </div>

</div>
